webpackJsonp([17],{"5w9C":function(e,a){},yvNh:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=t("woOf"),i=t.n(r),o=t("l/JR"),d={props:{addOilDialog:{type:Boolean,default:function(){return!1}},addType:{type:String,default:""},addOilForm:{type:Object,default:function(){return{}}},oilBrandList:{type:Array,default:function(){return[]}}},data:function(){return{oilBrandListAdd:[],brandError:!1,nameError:!1,noticeError:"",noticeErrorBrand:"",addOilForm:{oilBrand:"",oilName:""},checkOilName:!1,addOilRules:{oilBrand:[{required:!0,message:"请选择油品品牌",trigger:"change"}],oilBrandName:[{required:!0,message:"请输入",trigger:"blur"}],oilName:[{required:!0,message:"请输入油品名称",trigger:"blur"}]}}},created:function(){this.getOilBrandData()},methods:{getOilBrandData:function(){var e=this;this.requestMethodGet("/mdm/oil/queryOilList",{parentCode:0,status:1}).then(function(a){if(1e3==a.data.code){var t=a.data.data,r=[];0!==t.length&&(r=t.filter(function(e){return"oil_0001"!==e.code})),e.oilBrandListAdd=r,e.oilBrandListAdd.push({name:"自定义",code:"0"})}else e.$message({message:a.data.msg,type:"error"})})},checkedOil:function(e,a,t){var r=this,i=void 0;if(i=t?e:e.target.value){var d={productName:i};"brand"==a?d.parentNumber=0:"name"==a&&(d.parentNumber=this.addOilForm.oilBrand),Object(o.a)(),this.requestMethodPost("mdm/oil/checkOilName",d).then(function(e){1e3==e.data.code?"brand"==a?(r.brandError=!1,r.noticeErrorBrand=""):"name"==a&&(r.checkOilName=!0,r.nameError=!1,r.noticeError=""):4217==e.data.code?(r.brandError=!0,r.noticeErrorBrand=e.data.msg):4216==e.data.code?(r.checkOilName=!0,r.nameError=!0,r.noticeError=e.data.msg):r.$message({message:e.data.msg,type:"error"})})}},selectOilBrandAdd:function(){this.noticeError="",this.noticeErrorBrand="",this.$set(this.addOilForm,"oilBrandName",""),this.$set(this.addOilForm,"oilName","")},changeOil:function(e){e||(this.noticeError="")},cancelAddOil:function(){i()(this.$data.addOilForm,this.$options.data().addOilForm),this.$emit("closeDialogAdd")},getQueryOilList:function(e,a,t){var r=this;this.requestMethodGet("/mdm/oil/queryOilList",{parentCode:0,status:1}).then(function(i){if(1e3==(i=i.data).code){if(i.data&&i.data.length>0){var o=i.data;switch(o=o.map(function(e){return{value:e.code,label:e.name}}),e){case"recommendOilTypeList":r.recommendOilTypeList=o;break;case"oilBrandList":r.oilBrandList=o}}"add"==a&&"oilName"==r.addType&&r.$nextTick(function(){r.addOilForm.oilBrandCode=t})}else r.$message({message:i.msg,type:"warning"})}).catch(function(e){})},completeAddOil:function(e){var a=this;this.$refs[e].validate(function(e){if(e){if(a.checkOilName||a.checkedOil(a.addOilForm.oilName,"name","type"),a.brandError||a.nameError)return!1;a.addOrEditOil(a.addOilForm)}})},addOrEditOil:function(e){var a=this,t={oilBrand:e.oilBrand,oilName:e.oilName,customerCompanyNumber:JSON.parse(this.Decrypt(sessionStorage.getItem("userInfo"))).companyNumber};"0"==e.oilBrand&&(t.oilBrand="",t.customCode="1",t.oilBrandName=e.oilBrandName),this.FULLSCREENLOADING(),this.requestMethodPost("mdm/oil/addOil",t).then(function(t){1e3==t.data.code?("0"==e.oilBrand&&(a.getOilBrandData(),a.getQueryOilList("oilBrandList","add",t.data.data.oilBrandNumber)),a.$emit("addOilSuccess"),a.FULLSCREENENDLOADING()):a.$message({message:t.data.msg,type:"error"})})}},computed:{}},n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("el-form",{ref:"addOilRef",staticClass:"demo-ruleForm",attrs:{model:e.addOilForm,rules:e.addOilRules,"label-width":"100px","label-position":"left"}},[t("el-form-item",{staticClass:"filterConditionType",attrs:{prop:"oilBrand",label:"油品品牌"}},[t("el-select",{staticStyle:{width:"60%"},attrs:{size:"mini",clearable:""},on:{change:e.selectOilBrandAdd},model:{value:e.addOilForm.oilBrand,callback:function(a){e.$set(e.addOilForm,"oilBrand",a)},expression:"addOilForm.oilBrand"}},e._l(e.oilBrandListAdd,function(e){return t("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})}),1)],1),e._v(" "),"0"==e.addOilForm.oilBrand?t("el-form-item",{staticClass:"filterConditionType",attrs:{prop:"oilBrandName",label:""}},[t("el-input",{staticStyle:{width:"60%"},attrs:{size:"mini",clearable:"",maxlength:"25",placeholder:"请输入油品品牌"},on:{blur:function(a){return e.checkedOil(a,"brand")}},model:{value:e.addOilForm.oilBrandName,callback:function(a){e.$set(e.addOilForm,"oilBrandName",a)},expression:"addOilForm.oilBrandName"}}),e._v(" "),e.brandError&&e.addOilForm.oilBrandName?t("div",{staticStyle:{color:"#ff0000"}},[e._v(e._s(e.noticeErrorBrand))]):e._e()],1):e._e(),e._v(" "),t("el-form-item",{staticClass:"filterConditionType",attrs:{prop:"oilName",label:"油品名称"}},[t("el-input",{staticStyle:{width:"60%"},attrs:{size:"mini",clearable:"",maxlength:"25"},on:{blur:function(a){return e.checkedOil(a,"name")},change:e.changeOil},model:{value:e.addOilForm.oilName,callback:function(a){e.$set(e.addOilForm,"oilName",a)},expression:"addOilForm.oilName"}}),e._v(" "),e.nameError&&e.addOilForm.oilName?t("div",{staticStyle:{color:"#ff0000"}},[e._v(e._s(e.noticeError))]):e._e()],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.cancelAddOil("addOilRef")}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.completeAddOil("addOilRef")}}},[e._v("完 成")])],1)],1)};n._withStripped=!0;var l={render:n,staticRenderFns:[]},s=l;var c=!1;var m=t("VU/8")(d,s,!1,function(e){c||t("5w9C")},"data-v-a8275dc6",null);m.options.__file="src/components/equipment/components/addOilInner.vue";a.default=m.exports}});